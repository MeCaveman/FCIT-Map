@startuml FCITMap Class Diagram

' ============================================
' Core Data Types and Interfaces
' ============================================

interface ObjectItem {
  +id: string
  +name: string
  +desc: string
  +categoryId: string
  +categoryName?: string
}

interface Category {
  +id: string
  +name: string
}

interface Beacon {
  +_id: string
  +beacon_id: string
  +rssi: number
}

interface BleBeacon {
  +name: string
  +id: string
  +rssi: number
  +txPower: number
  +uuids: string[]
}

interface Navigation {
  +start: string
  +end?: string
}

' ============================================
' Graph Data Structures
' ============================================

interface VertexData {
  +id: string
  +objectName: string | null
  +cx: number
  +cy: number
}

interface EdgeData {
  +id: string
  +from: string
  +to: string
}

interface GraphData {
  +vertices: VertexData[]
  +edges: EdgeData[]
}

' ============================================
' Context Types
' ============================================

interface NavigationContextType {
  +navigation: Navigation
  +setNavigation: Dispatch<SetStateAction<Navigation>>
  +isEditMode: boolean
  +setIsEditMode: Dispatch<SetStateAction<boolean>>
}

interface MapDataContextType {
  +objects: ObjectItem[]
  +categories: Category[]
  +beacons?: Beacon[]
  +refetchData: () => void
}

interface AdminContextType {
  +isAdmin: boolean
  +setIsAdmin: Dispatch<SetStateAction<boolean>>
}

' ============================================
' Algorithm Classes
' ============================================

class PriorityQueue {
  -values: Node[]
  +constructor()
  +enqueue(id: NodeId, priority: number): void
  +dequeue(): Node
  -bubbleUp(): void
  -sinkDown(): void
}

class DijkstraCalculator {
  -adjacencyList: { [key: NodeId]: { id: NodeId; weight: number }[] }
  +constructor()
  +addVertex(vertex: NodeId): void
  +addEdge(vertex1: NodeId, vertex2: NodeId, weight?: number): void
  +calculateShortestPath(start: NodeId, finish: NodeId): string[]
}

' ============================================
' Component Props Interfaces
' ============================================

interface MapBackgroundProps {
  +children: ReactNode
}

interface ObjectsProps {
  +handleObjectClick: (objectId: string) => void
  +className?: string
}

interface PositionsProps {
  +positionRadius: number
  +handlePositionClick: (e: React.MouseEvent<SVGPathElement>): void
  +className: string
  +navigation?: Navigation
}

interface ParsedObjects {
  +[key: string]: { len: number; results: ObjectItem[] }
}

interface ObjectItemDetailsModalProps {
  +open: boolean
  +onClose: () => void
  +object: ObjectItem
  +objectNavigation: () => void
}

interface ObjectDetailsViewProps {
  +object: ObjectItem
  +onEdit: () => void
  +onNavigate: () => void
}

interface ObjectEditViewProps {
  +object: ObjectItem
  +onSave: (updatedObject: Partial<ObjectItem>) => void
  +onCancel: () => void
}

interface NewCategoryModalProps {
  +open: boolean
  +onClose: () => void
  +onCreate: (category: Partial<Category>) => void
}

interface DialogProps {
  +open: boolean
  +onClose: () => void
  +children: ReactNode
}

interface TooltipProps {
  +content: string
  +children: ReactNode
}

' ============================================
' Relationships
' ============================================

ObjectItem "uses" --> Category : categoryId
GraphData "contains" --> VertexData
GraphData "contains" --> EdgeData
VertexData "references" --> ObjectItem : objectName
NavigationContextType "uses" --> Navigation
MapDataContextType "uses" --> ObjectItem
MapDataContextType "uses" --> Category
MapDataContextType "uses" --> Beacon
DijkstraCalculator "uses" --> PriorityQueue
DijkstraCalculator "uses" --> VertexData
DijkstraCalculator "uses" --> EdgeData
ObjectsProps "uses" --> ObjectItem
PositionsProps "uses" --> Navigation
ObjectItemDetailsModalProps "uses" --> ObjectItem
ObjectDetailsViewProps "uses" --> ObjectItem
ObjectEditViewProps "uses" --> ObjectItem
NewCategoryModalProps "uses" --> Category
ParsedObjects "uses" --> ObjectItem

' ============================================
' Notes
' ============================================

note right of DijkstraCalculator
  Implements Dijkstra's algorithm
  for shortest path calculation
  Uses PriorityQueue for efficient
  node selection
end note

note right of GraphData
  Contains the complete graph
  structure with vertices and edges
  representing the indoor map layout
end note

note right of NavigationContextType
  React Context for managing
  navigation state (start/end points)
  and edit mode
end note

note right of MapDataContextType
  React Context for managing
  map data (objects, categories, beacons)
  and data fetching
end note

@enduml




